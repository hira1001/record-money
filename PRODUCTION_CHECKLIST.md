# 本番環境デプロイチェックリスト

## ✅ 実装済み項目

### 機能実装
- ✅ 主要機能（Dashboard、OCR、音声入力、Review Queue）
- ✅ データベーススキーマとRLS
- ✅ 認証システム（Google OAuth）
- ✅ API エンドポイント
- ✅ エラーハンドリング（基本的な実装）

### セキュリティ
- ✅ Row Level Security (RLS) 実装
- ✅ 認証チェック
- ✅ Webhook シークレット検証

## ⚠️ 本番環境デプロイ前に必要な修正

### 1. APIバリデーションの強化
- [ ] POST `/api/transactions` のリクエストボディ検証
- [ ] 入力値のサニタイゼーション
- [ ] レート制限の検討

### 2. エラーハンドリングの改善
- [ ] グローバルエラーページ (`error.tsx`)
- [ ] ローディングページ (`loading.tsx`)
- [ ] エラーログの適切な管理（console.errorの置き換え）

### 3. 環境変数の検証
- [ ] 起動時の環境変数チェック
- [ ] `.env.example` ファイルの作成

### 4. デプロイ設定
- [ ] `next.config.ts` の最適化設定
- [ ] ビルドエラーの確認
- [ ] パフォーマンス最適化

### 5. セキュリティ強化
- [ ] CORS設定
- [ ] レート制限
- [ ] 入力値のサニタイゼーション

### 6. 監視・ログ
- [ ] エラートラッキング（Sentry等）
- [ ] パフォーマンス監視

### 7. ドキュメント
- [ ] API ドキュメント
- [ ] デプロイ手順書
- [ ] 環境変数説明

## 📋 デプロイ前の必須作業

1. **Supabase設定**
   - [ ] データベーススキーマの適用 (`supabase/schema.sql`)
   - [ ] Google OAuth プロバイダーの有効化
   - [ ] RLS ポリシーの確認

2. **環境変数設定**
   - [ ] 本番環境の環境変数設定
   - [ ] シークレットキーの安全な管理

3. **PWAアイコン**
   - [ ] `public/icons/icon-192.png` の作成
   - [ ] `public/icons/icon-512.png` の作成

4. **テスト**
   - [ ] ビルドテスト (`npm run build`)
   - [ ] 主要機能の動作確認
   - [ ] エッジケースのテスト

## 🚀 デプロイ手順（Vercel推奨）

1. GitHubリポジトリにプッシュ
2. Vercelでプロジェクトをインポート
3. 環境変数を設定
4. デプロイ実行
5. 動作確認

## ⚠️ 注意事項

- 本番環境では `console.error` を適切なログサービスに置き換えることを推奨
- 環境変数は必ずVercelの環境変数設定で管理
- SupabaseのService Role Keyは絶対に公開しないこと


